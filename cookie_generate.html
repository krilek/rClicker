<html>

<body>
    <input type="button" onclick="getCookieValue()" value="check">
    <input type="button" onclick="encryptionMechanism('encrypt','wzsdz#daffgmkv#854#true#')" value="remove">
    <input type="button" onclick="saveGame();" value="create">
    <input type="button" onclick="loadGame()" value="load">
    <script type="text/javascript">
    var var1 = "wzsdz";
    var var2 = "daffgmkv";
    var var3 = 854;
    var var4 = true;
    var var5 = false;
    var var6 = 213.123;
    var var7 = "GREEN";

    function saveGame() {
        function collectData() {
            var output = "";
            for (i = 0; i < arguments.length; i++) {
                output += String(arguments[i]) + "#";
            }
            return output;
        }

        function setCookie(cname, cvalue, exdays) {
            var d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            var expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }
        data = collectData(var1, var2, var3);
        encryptedSave = encryptionMechanism("encrypt", data);
        setCookie('save', encryptedSave, 1);
        loadGame();
    }
    function loadGame() {
        function getCookieValue() {
            var cookie = document.cookie;
            for (i = 0; i < cookie.length; i++) {
                if (cookie.charAt(i) == "=")
                    return cookie.substr(i + 1);
            }
        }
        var savedGame = getCookieValue();
        var data = encryptionMechanism("decrypt", savedGame);
    }



    function encryptionMechanism(mode, data) {
        var output = "";
        var dataStart = 0;
        var key = "";
        var offset = 0;
        if (mode == "encrypt") {
            //Creation of key used later in encryption
            key += Math.floor(Math.random() * 1000);
            output = key + "#";

        } else if (mode == "decrypt") {

            //Getting key from encrypted data
            for (m = 0; m < 4; m++) {
                if (data.charAt(m) == "#") {
                    dataStart = m + 1;
                    break;
                } else {
                    key += data.charAt(m);
                }
            }
        } else {
            return "";
        }
        //Offset calculation
        for (i = 0; i < key.length; i++) {
            offset += parseInt(key.charAt(i));
        }
        if (mode == "decrypt") {
            offset *= -1;
        }
        //Initialization of array with signs
        var charArray = ["#", "."];
        for (i = 48; i < 123; i++) {
            if (i == 58) i = 65;
            if (i == 91) i = 97;
            charArray.push(String.fromCharCode(i));
        }
        //Main loop going through all letters in 'data' string
        for (j = dataStart; j < data.length; j++) {
            output += changeLetter(data.charAt(j), offset, charArray);
        }
        return output;

        function changeLetter(letter, offset, signs) {
            for (i = 0; i < signs.length; i++) {
                if (letter == signs[i]) {
                    if (signs.length > i + offset && 0 <= i + offset) {
                        return signs[i + offset];
                    } else {
                        var temp = Math.abs(signs.length - Math.abs(i + offset));
                        return signs[temp];
                    }
                }
            }
        }
    }
    </script>
</body>

</html>
